<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="jakarta.faces.html" xmlns:ui="jakarta.faces.facelets"
    xmlns:f="jakarta.faces.core">

<ui:composition template="/WEB-INF/templates/template.xhtml">
    <f:metadata>
        <f:viewParam name="modelId" value="#{modelDetailView.modelId}" converter="uuidConverter" />
        <f:viewAction action="#{modelDetailView.init}" />
    </f:metadata>

    <ui:define name="title">#{msg['model_detail.title']}</ui:define>
    <ui:define name="content">
        <h:link outcome="model_list" value="#{msg['action.back']}" styleClass="btn" />

        <h:panelGroup rendered="#{empty modelDetailView.model}">
            <p>#{msg['model_detail.not_found']}</p>
        </h:panelGroup>

        <h:panelGroup rendered="#{not empty modelDetailView.model}">
            <h2>#{msg['model_detail.title']}</h2>
            <p><strong>#{msg['model_detail.brand']}</strong> #{modelDetailView.model.brand}</p>
            <p><strong>#{msg['model_detail.model']}</strong> #{modelDetailView.model.name}</p>
            <p><strong>#{msg['model_detail.hp']}</strong> #{modelDetailView.model.hp}</p>
            <p><strong>#{msg['model_detail.id']}</strong> #{modelDetailView.model.id}</p>

            <h3>#{msg['model_detail.cars_title']}</h3>
            <h:link outcome="/car/car_form" value="#{msg['model_detail.add_car']}" styleClass="btn">
                <f:param name="modelId" value="#{modelDetailView.model.id}" />
            </h:link>

            <h:panelGroup id="carListPanel">
                <h:panelGroup rendered="#{empty modelDetailView.cars}">
                    <p>#{msg['model_detail.no_cars']}</p>
                </h:panelGroup>

                <h:panelGroup rendered="#{not empty modelDetailView.cars}">
                    <p>#{msg['model_detail.total_cars']} #{modelDetailView.cars.size()}</p>
                    <h:dataTable value="#{modelDetailView.cars}" var="car">
                        <h:column>
                            <f:facet name="header">#{msg['car.header.license_plate']}</f:facet>
                            #{car.licensePlate}
                        </h:column>
                        <h:column>
                            <f:facet name="header">#{msg['car.header.owner']}</f:facet>
                            #{empty car.owner ? msg['car.no_owner'] : car.owner.login}
                        </h:column>
                        <h:column>
                            <f:facet name="header">#{msg['car.header.mileage']}</f:facet>
                            #{car.mileage} km
                        </h:column>
                        <h:column>
                            <f:facet name="header">#{msg['car.header.purchase_date']}</f:facet>
                            #{car.purchaseDate}
                        </h:column>
                        <h:column>
                            <f:facet name="header">#{msg['models.header.action']}</f:facet>
                            <h:link outcome="/car/car_detail" value="#{msg['action.view']}" styleClass="btn">
                                <f:param name="carId" value="#{car.id}" />
                            </h:link>
                            <h:link outcome="/car/car_form" value="#{msg['action.edit']}" styleClass="btn">
                                <f:param name="carId" value="#{car.id}" />
                                <f:param name="modelId" value="#{modelDetailView.model.id}" />
                            </h:link>
                            <h:form style="display:inline;">
                                <h:commandButton value="#{msg['action.delete']}" styleClass="btn"
                                    action="#{modelDetailView.deleteCar(car.id)}">
                                    <f:ajax execute="@form" render=":carListPanel :messages" />
                                </h:commandButton>
                            </h:form>
                        </h:column>
                    </h:dataTable>
                </h:panelGroup>
            </h:panelGroup>
        </h:panelGroup>

        <h:messages id="messages" />
    </ui:define>
</ui:composition>

</html>